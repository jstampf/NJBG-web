!function(e){var t=!1,a=function(){var e,t=0,a="summary";return e=location.href.match(/\/userid\/\d+\//i),null!=e?(t=e[0].match(/\d+/)[0],a="profile"):(e=location.href.match(/\/groupid\/\d+\//i),null!=e&&(t=e[0].match(/\d+/)[0],a="group")),{type:a,target:t}},s=function(e){var t,a,i=0;return 0==e.length?0:(a=e.attr("class"),"string"!=typeof a||""==a?0:($.each(a.split(/\s+/),function(e,a){return t=a.match(/\d+$/),"object"==typeof t&&null!=t?(i=parseInt(t[0]),!1):void 0}),i))},n=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},o=function(o){o.fn.socialMediaBox=function(){var t,s,r,l,c,d,p,m,u,h,v,f,g,y,b,w,k,C,I,D,x,T,j,_,A,M,q,z,W,B,S,O,H,R,P,E,L,$,U,N,J,Y,X,G,F,K,Z,Q,V,ee,te,ae,ie,se,ne,oe,re={},le={openAt:0,baseClass:"",localized:{},flowplayerSwf:"",flowplayer:{key:"",logo:""},thumbnails:{show:!0,width:100,height:100},itemDetails:{show:!0,rightSide:!0,comments:{notifySocialGroup:!1,requireAuthorInfo:!0,captcha:!0,permissions:{commenting:!0,editing:!1,deleting:!1}},socialButtons:{show:!1,buttons:{facebook:{show:!1,html:'<iframe src="//www.facebook.com/plugins/like.php?href={{encodedUrl}}&amp;send=false&amp;layout=button_count&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;width=110" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width: 110px;" allowTransparency="true"></iframe>'},gplus:{show:!1,html:'<div class="g-plusone" data-size="medium" data-href="{{url}}"></div><script type="text/javascript">gapi.plusone.go();</script>'},twitter:{show:!1,html:'<a href="//twitter.com/share" class="twitter-share-button" data-url="{{url}}" data-text="{{escapedTitle}}">Tweet</a><script type="text/javascript">twttr.widgets.load();</script>'},inshare:{show:!1,html:'<script type="IN/Share" data-counter="right" data-url="{{url}}"></script><script type="text/javascript">IN.parse();</script>'},pinterest:{show:!1,html:'<a href="//pinterest.com/pin/create/button/?url={{encodedUrl}}&media={{encodedMediaUrl}}&description={{encodedTitle}}" class="pin-it-button" count-layout="horizontal"><img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" /></a>'}}}},events:{onBeforeClose:function(){}},googleReCaptchaSiteKey:""},ce=function(e){return"string"==typeof le.localized[e]?le.localized[e]:e},de=[],pe={activeItem:0,resizeInProgress:!1,resizeRace:!1,interfaceHidden:!1,baseWrapper:{height:0,width:0},thumbnails:{rendered:!1,initialized:!1,thumbActivatedChange:!1,allThumbnailsLoaded:!1,thumbnail:{height:0,width:0},wrapper:{height:0,effectiveHeight:0},overview:{width:0}},interfaceActions:{wrapper:{height:0}},itemDetails:{rendered:!1,wrapper:{verticalOffset:0,width:0,effectiveWidth:0},comments:{author:{avatarContainer:null}},maps:{google:null}},itemDisplay:{wrapper:{verticalOffset:0,horizontalOffset:0,height:0,width:0},touch:{newTouch:!1,startX:0,startY:0}},preloadedImages:{},commentsCache:{},reCaptchaId:e},me=function(t,a){a?(pe.preloadedImages[t].state="success",pe.preloadedImages[t].width=this.naturalWidth===e?this.width:this.naturalWidth,pe.preloadedImages[t].height=this.naturalHeight===e?this.height:this.naturalHeight):pe.preloadedImages[t].state="error",clearTimeout(pe.preloadedImages[t].timeout)},ue=function(e){for(var t=pe.preloadedImages[e].callbacks;t.length>0;)t.splice(0,1)[0]();pe.preloadedImages[e].callbacks=[]};return terminated=!1,re.preloadImage=function(t,a){var i=o("<img />"),s=i[0],n=!1,r="number"==typeof a?a:0;if(0==r){if(pe.preloadedImages[t]!==e)return void("loading"==pe.preloadedImages[t].state?pe.preloadedImages[t].callbacks.push(a):a());pe.preloadedImages[t]={state:"loading",callbacks:[a]}}return pe.preloadedImages[t].timeout=setTimeout(function(){!terminated&&10>r&&re.preloadImage(t,r+1)},4e3*(r+1)),i.bind("load.socialMediaBox error.socialMediaBox",function(e){n||"loading"!=pe.preloadedImages[t].state||(me.apply(s,[t,"load"==e.type]),ue(t))}),s.src=t,s.complete&&s.naturalWidth!==e?(n=!0,me.apply(s,[t,0!==s.naturalWidth&&0!==s.naturalHeight]),void ue(t)):void 0},re.resize=function(){var e,t,a,i,n,o;return pe.resizeInProgress?void(pe.resizeRace=!0):(pe.resizeInProgress=!0,pe.baseWrapper.height=s.height(),pe.baseWrapper.width=s.width(),re.thubnails.resize(),re.itemDetails.resize(),re.itemDisplay.resize(),re.interfaceActions.resize(),de.length>1&&(e=Math.floor((pe.itemDisplay.wrapper.height+pe.itemDisplay.wrapper.verticalOffset-se.height())/2),t=pe.itemDisplay.wrapper.width+pe.itemDisplay.wrapper.horizontalOffset-ne.outerWidth(!0),le.itemDetails.rightSide?(a={top:e,left:0,right:"auto"},i={top:e,left:t,right:"auto"}):(a={top:e,left:"auto",right:t},i={top:e,left:"auto",right:0}),se.css(a),ne.css(i)),o=pe.itemDisplay.wrapper.width+pe.itemDisplay.wrapper.horizontalOffset-oe.outerWidth(!0),n=le.itemDetails.rightSide?{left:o,right:"auto"}:{left:"auto",right:o},oe.css(n),pe.resizeInProgress=!1,void(pe.resizeRace&&(pe.resizeRace=!1,re.resize())))},re.showItem=function(e,t){0>e?e=de.length-1:e>=de.length&&(e=0),(t===!0||pe.activeItem!=e)&&(pe.activeItem=e,re.itemDisplay.showItem(),re.itemDetails.showItem(),re.thubnails.showItem())},re.callbackObject=function(){return{activeItem:pe.activeItem,displayItems:de}},re.close=function(){("function"!=typeof le.events.onBeforeClose||le.events.onBeforeClose(re.callbackObject())!==!1)&&(terminated=!0,o(document).off(".socialMediaBox"),o(window).off(".socialMediaBox"),s.fadeOut(200,function(){s.remove(),t.removeClass("socialMediaBoxActive")}))},re.thubnails={},re.thubnails.init=function(){var t;!le.thumbnails.show||de.length<2||(pe.thumbnails.rendered=!0,r=o('<div class="thumbnailsMainWrapper"><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div><div class="viewport"><div class="overview"></div></div></div>'),l=o("> div.viewport",r),c=o("> div.overview",l),o.each(de,function(t,a){var i=o('<div><div class="'+a.type+'">'+("video"==a.type||"audio"==a.type?'<div class="playItem"></div>':"")+"</div></div>").appendTo(c);a.thumbnail!==e&&a.thumbnail.src!==e?re.preloadImage(a.thumbnail.src,function(){var e,t,s,n,o=le.thumbnails.height,r=le.thumbnails.width,l=r/o;"success"==pe.preloadedImages[a.thumbnail.src].state&&(t=pe.preloadedImages[a.thumbnail.src].height,s=pe.preloadedImages[a.thumbnail.src].width,(t>o||s>r)&&(n=s/t,l>n?(s=Math.round(o/t*s),t=o):n>l?(t=Math.round(r/s*t),s=r):(s=r,t=o)),e=t>o?0:Math.floor((o-t)/2),i.css("top",e).fadeIn(300).addClass("visible").find("> div").prepend('<img src="'+a.thumbnail.src+'" alt="" style="height: '+t+"px; width: "+s+'px;" />'),pe.thumbnails.initialized&&re.thubnails.resize())}):i.fadeIn(300).addClass("visible").find("> div").prepend('<div class="noThumb"></div>')}),t=o("> div",c).eq(0),r.appendTo(s),o(">",t).css({width:le.thumbnails.width,height:le.thumbnails.height}),pe.thumbnails.thumbnail.height=t.outerHeight(!0),pe.thumbnails.thumbnail.width=t.outerWidth(!0),o(">",t).css({width:"",height:""}),c.height(pe.thumbnails.thumbnail.height),l.height(pe.thumbnails.thumbnail.height),pe.thumbnails.wrapper.height=pe.thumbnails.wrapper.effectiveHeight=r.outerHeight(!0),r.eds_tinyscrollbar({axis:"x"}),c.on("click","> div",function(){pe.thumbnails.thumbActivatedChange=!0,re.showItem(o(this).index())}),pe.thumbnails.initialized=!0)},re.thubnails.resize=function(){var e,t,a,i=0,s=pe.thumbnails.thumbnail.width;if(le.thumbnails.show&&!(de.length<2)){if(pe.thumbnails.thumbActivatedChange)return void(pe.thumbnails.thumbActivatedChange=!1);pe.thumbnails.allThumbnailsLoaded||(a=o("> div.visible",c),de.length==a.length&&(pe.thumbnails.allThumbnailsLoaded=!0),pe.thumbnails.overview.width=0,a.each(function(){pe.thumbnails.overview.width+=o(this).outerWidth(!0)}),c.width(pe.thumbnails.overview.width)),e=r.width(),t=pe.thumbnails.overview.width,t>e?(c.css({left:0}),i=s*pe.activeItem+Math.floor(s/2),i<=Math.floor(e/2)?i=0:t-i<=Math.ceil(e/2)?i="bottom":i-=Math.floor(e/2),r.data("plugin_eds_tinyscrollbar").update(i)):(r.data("plugin_eds_tinyscrollbar").update(),c.css({left:Math.floor((e-t)/2)}))}},re.thubnails.showItem=function(){!le.thumbnails.show||de.length<2||(o("> div",c).removeClass("active").eq(pe.activeItem).addClass("active"),re.thubnails.resize())},re.interfaceActions={},re.interfaceActions.init=function(){var e;d=o('<div class="interfaceActionsWrapper"></div>'),(pe.thumbnails.rendered||pe.itemDetails.rendered)&&(p=o('<div class="action toggleInterface"><span>'+ce("Hide interface")+"</span></div>").appendTo(d).on("click",function(){var t,a;pe.interfaceHidden?(pe.interfaceHidden=!1,e.text(ce("Hide interface")),p.removeClass("hidden")):(pe.interfaceHidden=!0,e.text(ce("Show interface")),p.addClass("hidden")),pe.thumbnails.rendered&&(t=pe.interfaceHidden?-pe.thumbnails.wrapper.height:0,r.stop(!0).animate({bottom:t},{duration:200,step:function(e){pe.thumbnails.wrapper.effectiveHeight=Math.round(pe.thumbnails.wrapper.height+e),re.resize()}})),pe.itemDetails.rendered&&(a=le.itemDetails.rightSide?pe.interfaceHidden?{right:-pe.itemDetails.wrapper.width}:{right:0}:pe.interfaceHidden?{left:-pe.itemDetails.wrapper.width}:{left:0},m.stop(!0).animate(a,{duration:200,step:function(e){pe.itemDetails.wrapper.effectiveWidth=Math.round(pe.itemDetails.wrapper.width+e),re.resize()}}))}),e=o("> span",p)),s.append(d),pe.interfaceActions.wrapper.height=d.outerHeight(!0)},re.interfaceActions.resize=function(){d.css({bottom:pe.thumbnails.wrapper.effectiveHeight})},re.itemDetails={comments:{}},re.itemDetails.init=function(){var t='<h2></h2><div class="description"></div>',n='<div class="ratingWrapper">					<div class="starContainer">						<div></div>					</div>					<p class="score"></p>					<p class="message"></p>				</div>',r='<div class="commentsWrapper">					<h3>'+ce("Comments")+'</h3>					<div class="loading"></div>					<p class="message"></p>					<div class="commentsList"></div>					<div class="addCommentContainer">						<div class="commentingMessage"></div>						<div class="authorInfo name"><div class="text"><span class="label">'+ce("Name")+'</span><input type="text" value="" /></div></div>						<div class="authorInfo email"><div class="text"><span class="label">'+ce("Email")+'</span><input type="text" value="" /></div></div>						<div class="textarea"><textarea></textarea></div>						<div class="captchaContainer"><div class="captcha"></div></div>						<button class="add"><span>'+ce("Add comment")+"</span></button>					</div>				</div>",l='<div class="authorWrapper">					<div class="avatarWrapper">						<div class="avatarContainer"></div>					</div>					<div class="actions">						<button class="follow"><span>'+ce("follow")+'</span></button>						<button class="friend"><span>'+ce("add as friend")+'</span></button>						<button class="friend rejectRequest"><span>'+ce("reject friend request")+'</span></button>					</div>					<p class="postedBy">'+ce("posted by")+'</p>					<p class="name"></p>					<p class="date"></p>				</div>',c='<div class="likeWrapper">					<div class="likeContainer">						<button><span>'+ce("like")+'</span></button>						<p></p>					</div>					<ul class="alsoLiked"></ul>				</div>',d='<ul class="tagContainer"></ul>',p='<div class="buttonsWrapper">					<a href="#" class="email"><span>'+ce("Send link")+'</span></a>					<a href="#" target="_blank" class="download"><span>'+ce("Download")+"</span></a>				</div>",te='<div class="socialButtonsWrapper"></div>',ae='<div class="metaWrapper"><h3><span>'+ce("Details")+'</span></h3><div class="content"></div></div>';le.itemDetails.show&&(m=o('<div class="itemDetailsWrapper '+(le.itemDetails.rightSide?"right":"left")+'"><div class="viewport"><div class="overview">'+t+l+c+te+n+d+p+r+ae+'</div></div><div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div></div>'),u=o("> .viewport",m),h=o("> .overview",u),v=o("> h2",h),f=o("> div.description",h),g=o("> .authorWrapper",h),y=o("> .avatarWrapper",g),b=o("> .avatarContainer",y),w=o("> .name",g),k=o("> .date",g),C=o("> .actions",g),I=o("> .follow",C),D=o("> .friend",C).eq(0),x=o("> .friend",C).eq(1),T=o("> .likeWrapper",h),j=o("> .likeContainer",T),_=o("> button",j),A=o("> p",j),M=o("> .alsoLiked",T),q=o("> .socialButtonsWrapper",h),z=o("> .ratingWrapper",h),W=o("p.score",z),B=o("p.message",z),S=o("> div.starContainer",z),O=o("> div",S),H=o("> .tagContainer",h),R=o("> .buttonsWrapper",h),P=o("> .download",R),E=o("> .email",R),L=o("> div.commentsWrapper",h),$=o("> p.message",L),U=o("> div.commentsList",L),N=o("> div.loading",L),J=o("> div.addCommentContainer",L),Y=o("> button.add",J),X=o("> div > textarea",J),G=o("> .commentingMessage",J),F=o("> .authorInfo",J),K=o("> .text",F),Z=o("> div.captchaContainer",J),Q=o("> .metaWrapper",h),V=o("> h3",Q),ee=o("> .content",Q),s.append(m),pe.itemDetails.wrapper.verticalOffset=m.outerHeight(!0)-m.height(),pe.itemDetails.wrapper.width=pe.itemDetails.wrapper.effectiveWidth=m.outerWidth(!0),q.css("display",le.itemDetails.socialButtons.show?"block":"none"),K.click(function(){var e=o(this),t=o("> input",e);return t.focus(),!1}),o("> input",K).focus(function(){var e=o(this).siblings("span");""==this.value&&e.stop(!0).fadeTo(200,0,function(){e.css("display","none")})}).blur(function(){""==this.value&&o(this).siblings("span").stop(!0).css("display","").fadeTo(200,1)}),Y.on("click",function(){var t,i,s,n=X.val(),r=pe.activeItem,l=de[r],c="",d={},p={},u=[],h="",v=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=a(),g={action:"add_comment",journalType:f.type,journalTarget:f.target};if(!J.hasClass("sending")){if(le.itemDetails.comments.notifySocialGroup&&(g.notifySocialGroup=!0,g.journalModuleId=0),le.itemDetails.comments.requireAuthorInfo&&(t=o("> div > input",F.filter(".name")).val(),i=o("> div > input",F.filter(".email")).val(),""===t&&u.push(ce("a name")),""!==i&&v.test(i)||u.push(ce("a valid email address"))),""==n&&u.push(ce("a comment")),le.itemDetails.comments.requireAuthorInfo&&le.itemDetails.comments.captcha&&(s=grecaptcha.getResponse(pe.reCaptchaId),""===s&&u.push(ce("the captcha"))),0!==u.length)return h="<p>"+ce("Please specify")+" ",o.each(u,function(e,t){e>0&&(h+=e+1==u.length?" "+ce("and")+" ":", "),h+=t}),h+="</p>",G.css("display","block").removeClass("positive").html(h).addClass("negative"),void m.data("plugin_eds_tinyscrollbar").update("relative");X[0].disabled=!0,J.addClass("sending"),G.css("display","block").removeClass("negative positive").html("<p>"+ce("Sending...")+"</p>"),g.comment=n,le.itemDetails.comments.requireAuthorInfo&&(g.name=t,g.email=i,le.itemDetails.comments.captcha&&(g.captcha=s)),o.ajax({data:g,dataType:"json",type:"POST",url:l.comments.backend,timeout:15e3,cache:!1,error:function(){c=ce("The comment can't currently be saved. Please try again later.")},success:function(t){if(t.status==e)return void(c=ce("The comment can't currently be saved. Please try again later."));switch(t.status){case"success":d.author=t.author.id,d.content=t.comment,d.raw=n,d.id=t.id,d.dateHtml=t.dateHtml,pe.commentsCache[l.comments.backend].comments.push(d),p=pe.commentsCache[l.comments.backend].authors[d.author]==e?pe.commentsCache[l.comments.backend].authors[d.author]={avatar:t.author.avatar,name:t.author.name,url:t.author.url}:pe.commentsCache[l.comments.backend].authors[d.author];break;case"error":c=t.message;break;case"captcha_error":c=t.message}},complete:function(){r==pe.activeItem&&(""==c?(U.css("display","block"),$.css("display","none"),re.itemDetails.comments.renderCommentBox(d,p),re.itemDetails.comments.setAvatarContainerDimensions(),re.itemDetails.comments.loadAvatars(d.author,p),X.val(""),G.css("display","none")):G.css("display","block").addClass("negative").html("<p>"+c+"</p>"),J.removeClass("sending"),X[0].disabled=!1,le.itemDetails.comments.requireAuthorInfo&&le.itemDetails.comments.captcha&&grecaptcha.reset(pe.reCaptchaId),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative")}}),U.on("click",".actionsBoxTrigger li.edit",function(){var e,t=o(this),a=t.parents().eq(2),i=o("> .content",a),s=!1,n=de[pe.activeItem];return s="object"==typeof n.comments&&"object"==typeof n.comments.permissions&&"boolean"==typeof n.comments.permissions.editing?n.comments.permissions.editing:le.itemDetails.comments.permissions.editing,a.data("editing")||!s?!1:(clearTimeout(a.data("saveMsgTimeout")),a.data("editing",!0),o("> .editor",a).remove(),i.css("display","none"),e=o('<div class="editor"><div class="textarea"><textarea style="height: '+i.height()+'px;"></textarea></div><div class="actions"><p></p><span class="save">'+ce("Save")+'</span><span class="cancel">'+ce("Cancel")+"</span></div></div>").appendTo(a),o(".textarea > textarea",e).val(a.data("comment").raw).focus(),m.data("plugin_eds_tinyscrollbar").update("relative"),!1)}).on("click",".editor > .actions > span",function(){var t,a,i,s,n=o(this),r=n.parent(),l=n.parents().eq(2),c=l.data("comment"),d="",p=pe.activeItem,u=de[p],h={};if(l.data("saving"))return!1;if(n.hasClass("save")){if(i=o("> .editor > .textarea > textarea",l),s=i.val(),""==s)return a=o("> p",r).text(ce("Please specify a comment")).addClass("negative").removeClass("positive").css("display","block"),void m.data("plugin_eds_tinyscrollbar").update("relative");l.data("saving",!0),i[0].disabled=!0,a=o("> p",r).text(ce("Saving...")).removeClass("negative positive").css("display","block"),t=o("> span",r).css("display","none"),o.ajax({data:{action:"edit_comment",id:c.id,comment:s},dataType:"json",type:"POST",url:u.comments.backend,timeout:15e3,cache:!1,error:function(){d=ce("Your changes can't currently be saved.")},success:function(t){if(t.status==e)return void(d=ce("Your changes can't currently be saved."));switch(t.status){case"success":h=o.extend(!0,{},c,{raw:s,content:t.comment,dateHtml:t.dateHtml}),o.each(pe.commentsCache[u.comments.backend].comments,function(e,t){return t.id==c.id?(pe.commentsCache[u.comments.backend].comments[e]=h,!1):void 0});break;case"error":d=t.message}},complete:function(){p==pe.activeItem&&(d?(i[0].disabled=!1,t.css("display",""),a.addClass("negative").text(d)):(a.addClass("positive").text(ce("Your changes were saved")),o("> .editor > .textarea",l).remove(),o("> .content",l).css("display","block").html(h.content),o("> .meta > .commentDate",l).html(h.dateHtml),l.data({editing:!1,comment:h,saveMsgTimeout:setTimeout(function(){terminated||p!=pe.activeItem||o("> .editor",l).remove(),m.data("plugin_eds_tinyscrollbar").update("relative")},3e3)})),l.data("saving",!1),m.data("plugin_eds_tinyscrollbar").update("relative"))}})}else l.data("editing",!1),o("> .editor",l).remove(),o("> .content",l).css("display","block");return m.data("plugin_eds_tinyscrollbar").update("relative"),!1}).on("click",".actionsBoxTrigger li.delete",function(){var e=o(this),t=e.parents().eq(2);return t.addClass("hideActions"),o("> .deleteConfirmation",t).css("display","block"),m.data("plugin_eds_tinyscrollbar").update("relative"),!1}).on("click",".deleteConfirmation span",function(){var t=o(this),a=t.parents().eq(2),i=(a.index(),a.data("comment")),s=o("> .deleteConfirmation",a),n=o("> .message",s),r="",l=pe.activeItem,c=de[l];return t.hasClass("delete")?(o("> p",s).css("display","none"),n.text(ce("Deleting...")).css("display","block"),o.ajax({data:{action:"delete_comment",id:i.id},dataType:"json",type:"GET",url:c.comments.backend,timeout:15e3,cache:!1,error:function(){r=ce("The comment can't currently be deleted.")},success:function(t){if(t.status==e)return void(r=ce("Your changes can't currently be saved."));switch(t.status){case"success":o.each(pe.commentsCache[c.comments.backend].comments,function(e,t){return t.id==i.id?(pe.commentsCache[c.comments.backend].comments.splice(e,1),!1):void 0});break;case"error":r=t.message}},complete:function(){l==pe.activeItem&&(r?(n.addClass("negative").text(r),a.removeClass("hideActions")):(a.remove(),0==o(">",U).length&&(U.css("display","none"),$.addClass("noComments").text(ce("No comments yet")).css("display","block"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}})):(a.removeClass("hideActions"),s.css("display","none"),n.css("display","none")),m.data("plugin_eds_tinyscrollbar").update("relative"),!1}),S.on("mousemove",function(t){var a,i,s=de[pe.activeItem],n=S.offset();s.rating.rated||s.rating.backend==e||(a=S.width()/5,i=Math.ceil((t.clientX-n.left)/a),S.data("stars",i),O.css("width",a*i+"px"))}).on("mouseleave",function(){var t=de[pe.activeItem],a=t.rating.score;t.rating.backend!=e&&(t.rating.rated!==!1&&(a=t.rating.rated),O.css("width",a/5*100+"%"))}).on("click",function(){var t=pe.activeItem,a=de[t],i=!1,s=ce("Rating is currently not possible.");a.rating.rated===!1&&a.rating.backend!=e&&(de[t].rating.rated=S.data("stars"),S.addClass("rated"),O.css("width",a.rating.rated/5*100+"%"),o.ajax({data:{action:"rate",rating:a.rating.rated},dataType:"json",type:"POST",url:a.rating.backend,timeout:15e3,cache:!1,error:function(){i=s},success:function(a){if(a.status==e)return void(i=s);switch(a.status){case"success":de[t].rating.score=a.score;break;case"error":i=a.message}},complete:function(){i&&(de[t].rating.rated=!1),t==pe.activeItem&&(i?(S.removeClass("rated"),O.css("width",de[t].rating.score/5*100+"%"),B.addClass("negative").css("display","block").text(i)):W.removeClass("noRatings").text(de[t].rating.score),m.data("plugin_eds_tinyscrollbar").update("relative"))}}))}),I.on("click",function(){var t=pe.activeItem,a=de[t],s=!1,n=!a.author.following;I.data("disabled")!==!0&&(I.data("disabled",!0).addClass("requesting"),o.ajax({data:{action:"follow",follow:n},dataType:"json",type:"POST",url:a.author.backend,timeout:1e4,cache:!1,error:function(){s=!0},success:function(t){if(t.status==e)return void(s=!0);switch(t.status){case"success":for(i in de)"object"==typeof de[i].author&&"undefined"!=typeof de[i].author.id&&de[i].author.id==a.author.id&&(de[i].author.following=n);break;case"error":s=!0}},complete:function(){t==pe.activeItem&&(I.data("disabled",!1).removeClass("requesting"),s||(n?I.addClass("unfollow").find("> span").text(ce("unfollow")):I.removeClass("unfollow").find("> span").text(ce("follow"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),D.on("click",function(){var t,a=pe.activeItem,s=de[a],n=!1;D.data("disabled")!==!0&&(D.data("disabled",!0).addClass("requesting"),"requested_by_author"==s.author.friends?(x.addClass("requesting"),t=!0):t=s.author.friends===!0||"requested_by_user"==s.author.friends?!1:!0,o.ajax({data:{action:"friend",friends:t},dataType:"json",type:"POST",url:s.author.backend,timeout:1e4,cache:!1,error:function(){n=!0},success:function(a){if(a.status==e)return void(n=!0);switch(a.status){case"success":t=a.friends;for(i in de)"object"==typeof de[i].author&&"undefined"!=typeof de[i].author.id&&de[i].author.id==s.author.id&&(de[i].author.friends=t);break;case"error":n=!0}},complete:function(){a==pe.activeItem&&(D.data("disabled",!1).removeClass("requesting"),x.removeClass("requesting"),n||(x.css("display","none"),D.removeClass("unfriend cancelRequest acceptRequest"),t===!0?D.addClass("unfriend").find("> span").text(ce("unfriend")):"requested_by_user"==t?D.addClass("cancelRequest").find("> span").text(ce("cancel friend request")):D.find("> span").text(ce("add as friend"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),x.on("click",function(){var t=pe.activeItem,a=de[t],s=!1;"requested_by_author"==a.author.friends&&D.data("disabled")!==!0&&(D.data("disabled",!0).addClass("requesting"),x.addClass("requesting"),o.ajax({data:{action:"friend",friends:!1},dataType:"json",type:"POST",url:a.author.backend,timeout:1e4,cache:!1,error:function(){s=!0},success:function(t){if(t.status==e)return void(s=!0);switch(t.status){case"success":for(i in de)"object"==typeof de[i].author&&"undefined"!=typeof de[i].author.id&&de[i].author.id==a.author.id&&(de[i].author.friends=!1);break;case"error":s=!0}},complete:function(){t==pe.activeItem&&(D.data("disabled",!1).removeClass("requesting unfriend cancelRequest acceptRequest"),x.removeClass("requesting"),s||(x.css("display","none"),D.find("> span").text(ce("add as friend"))),m.data("plugin_eds_tinyscrollbar").update("relative"))}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),_.on("click",function(){var t=pe.activeItem,a=de[t],i=!1,s=!a.likes.liked;_.data("disabled")!==!0&&(_.data("disabled",!0).addClass("requesting"),o.ajax({data:{action:"like",liked:s},dataType:"json",type:"POST",url:a.likes.backend,timeout:1e4,cache:!1,error:function(){i=!0},success:function(a){if(a.status==e)return void(i=!0);switch(a.status){case"success":de[t].likes.liked=s,de[t].likes.message=a.message;break;case"error":i=!0}},complete:function(e){var a;if(t==pe.activeItem){if(_.data("disabled",!1).removeClass("requesting"),i){try{a=o.parseJSON(e.responseText).message}catch(n){a=ce("An error occurred while "+(s?"saving your like":"removing your like"))}A.addClass("negative").text(a)}else A.removeClass("negative").text(de[t].likes.message),s?_.addClass("unlike").find("> span").text(ce("unlike")):_.removeClass("unlike").find("> span").text(ce("like"));m.data("plugin_eds_tinyscrollbar").update("relative")}}}),m.data("plugin_eds_tinyscrollbar").update("relative"))}),V.on("click",function(){var e=de[pe.activeItem],t="block";ee.is(":visible")&&(t="none"),ee.css("display",t),"block"==t?(V.addClass("close"),"object"==typeof e.meta.map&&"google"==e.meta.map.type&&(google.maps.event.trigger(pe.itemDetails.maps.google,"resize"),pe.itemDetails.maps.google.setCenter(new google.maps.LatLng(e.meta.map.settings.lat,e.meta.map.settings.lng)))):V.removeClass("close"),m.data("plugin_eds_tinyscrollbar").update("relative")}),pe.itemDetails.rendered=!0,m.eds_tinyscrollbar({axis:"y"}))},re.itemDetails.placeAvatar=function(t){var a,i,s,n,o=0,r=0,l=null,c=null,d=pe.preloadedImages[t.src];return t.fadeIn==e&&(t.fadeIn=!1),d===e||"loading"==d.state?(t.fadeIn=!0,void re.preloadImage(t.src,function(){re.itemDetails.placeAvatar(t)})):("object"==typeof t.containerDimensions?(a=t.containerDimensions.height,i=t.containerDimensions.width):(a=t.$container.height(),i=t.$container.width()),"success"==d.state&&(l=d.height+4,c=d.width+4,(l>a||c>i)&&(n=c/l,s=i/a,s>n?(c=Math.round(a/l*c),l=a):n>s?(l=Math.round(i/c*l),c=i):(c=i,l=a)),r=l==a?0:Math.floor((a-l)/2),o=c==i?0:Math.floor((i-c)/2),l-=4,c-=4),t.$container.append('<img src="'+t.src+'" alt="" style="'+(t.fadeIn?"display: none; ":"")+(null!=c?"width: "+c+"px; ":"")+(null!=l?"height: "+l+"px; ":"")+"top: "+r+"px; left: "+o+'px;" />'),void(t.fadeIn&&t.$container.find(">").fadeIn(200)))},re.itemDetails.comments.renderCommentBox=function(e,t){var a,i,s,n=de[pe.activeItem],r=!1,l=!1;r="object"==typeof n.comments&&"object"==typeof n.comments.permissions&&"boolean"==typeof n.comments.permissions.editing?n.comments.permissions.editing:le.itemDetails.comments.permissions.editing,l="object"==typeof n.comments&&"object"==typeof n.comments.permissions&&"boolean"==typeof n.comments.permissions.deleting?n.comments.permissions.deleting:le.itemDetails.comments.permissions.deleting,a=(r&&n.journalEntry!==!0?'<li class="edit"><span>'+ce("Edit")+"</span></li>":"")+(l?'<li class="delete"><span>'+ce("Delete")+"</span></li>":""),s="string"==typeof t.url&&""!=t.url?'<a href="'+t.url+'">'+t.name+"</a>":t.name,i=o('<div class="author-'+e.author+("string"==typeof t.avatar&&""!=t.avatar?" hasAvatar":"")+'"><div class="deleteConfirmation"><p class="message"></p><p>'+ce("Do you really want to delete this comment?")+'</p><p><span class="delete">'+ce("Yes")+'</span><span class="cancel">'+ce("No")+'</span></p></div><div class="meta"><div class="authorAvatarWrapper"><div class="authorAvatarContainer"></div></div><h4>'+s+'</h4><p class="commentDate">'+e.dateHtml+'</p></div><div class="content">'+e.content+"</div>"+(""==a?"":'<div class="actionsBoxTrigger"><ul>'+a+"</ul></div>")+"</div>").data("comment",e),U.append(i)},re.itemDetails.comments.loadAvatars=function(t,a){var i,s=o("> .author-"+t+" > .meta > .authorAvatarWrapper",U).filter(":hidden");0!=s.lenght&&a.avatar!==e&&""!=a.avatar&&(s.css("display","block"),"string"==typeof a.url&&""!=a.url?(o(">",s).append(o('<a href="#" />').attr("href",a.url)),i=o("> >",s)):i=o(">",s),re.itemDetails.placeAvatar({src:a.avatar,$container:i,containerDimensions:pe.itemDetails.comments.author.avatarContainer}))},re.itemDetails.comments.setAvatarContainerDimensions=function(){null==pe.itemDetails.comments.author.avatarContainer&&($authorAvatarWrapper=o(".authorAvatarWrapper",U).eq(0).css("display","block"),pe.itemDetails.comments.author.avatarContainer={width:$authorAvatarWrapper.width(),height:$authorAvatarWrapper.height()},$authorAvatarWrapper.css("display","none"))},re.itemDetails.comments.display=function(e){var t=de[pe.activeItem],a=!1;N.css("display","none"),e.comments.length>0?($.css("display","none"),U.empty(),o.each(e.comments,function(t,a){re.itemDetails.comments.renderCommentBox(a,e.authors[a.author])}),U.css("display","block"),re.itemDetails.comments.setAvatarContainerDimensions(),o.each(e.authors,re.itemDetails.comments.loadAvatars)):(U.empty().css("display","none"),$.addClass("noComments").text(ce("No comments yet")).css("display","block")),a="object"==typeof t.comments&&"object"==typeof t.comments.permissions&&"boolean"==typeof t.comments.permissions.commenting?t.comments.permissions.commenting:le.itemDetails.comments.permissions.commenting,a?(le.itemDetails.comments.requireAuthorInfo?(F.css("display","block"),le.itemDetails.comments.captcha&&(Z.css("display","block"),pe.reCaptchaId?grecaptcha.reset(pe.reCaptchaId):pe.reCaptchaId=grecaptcha.render(o("> .captcha",Z)[0],{sitekey:le.googleReCaptchaSiteKey,size:"compact"}))):(F.css("display","none"),Z.css("display","none")),J.removeClass("sending").css("display","block"),X[0].disabled=!1,G.css("display","none"),X.val("")):J.css("display","none")},re.itemDetails.showItem=function(){var t,a,i,s=pe.activeItem,n=de[s],r="",l=!1,c="",d="",p="",u="",h="";if(le.itemDetails.show){if(n.title==e||""==n.title?(v.css("display","none"),f.removeClass("withTitle")):(v.text(n.title).css("display","block"),f.addClass("withTitle")),n.description==e||""==n.description?f.css("display","none"):f.html(n.description).css("display","block"),le.itemDetails.socialButtons.show&&"object"==typeof n.social&&""!=n.social.url?(d="string"!=typeof n.social.media?"":n.social.media,o.each(le.itemDetails.socialButtons.buttons,function(e,t){if(t.show){if("pinterest"==e&&""==d)return;if("twitter"==e&&("undefined"==typeof twttr||"undefined"==typeof twttr.widgets))return;if("inshare"==e&&("undefined"==typeof IN||"function"!=typeof IN.parse))return;c+="<div>"+t.html+"</div>"}}),""==c?q.css("display","none").empty():("string"==typeof n.title&&""!=n.title?(h=n.title.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),c=c.replace(/{{encodedTitle}}/g,encodeURIComponent(n.title))):c=c.replace(/{{encodedTitle}}/g,""),c=c.replace(/{{url}}/g,n.social.url).replace(/{{escapedTitle}}/g,h).replace(/{{encodedUrl}}/g,encodeURIComponent(n.social.url)),d&&(c=c.replace(/{{encodedMediaUrl}}/g,encodeURIComponent(d))),q.css("display","block").html(c),d&&le.itemDetails.socialButtons.buttons.pinterest.show&&o.ajax({url:"//assets.pinterest.com/js/pinit.js",dataType:"script",cache:!1}))):q.css("display","none").empty(),"object"==typeof n.rating?(S.removeClass("rated"),n.rating.score>0?(W.removeClass("noRatings").text(n.rating.score),n.rating.rated===!1?t=n.rating.score:(t=n.rating.rated,S.addClass("rated")),O.css("width",t/5*100+"%")):(W.addClass("noRatings").text(ce("No ratings")),O.css("width","")),B.css("display","none").removeClass("negative"),z.css("display","block"),n.rating.backend==e?z.addClass("cantRate"):z.removeClass("cantRate")):z.css("display","none"),"object"!=typeof n.comments||n.comments.backend==e||""==n.comments.backend?L.css("display","none"):(L.css("display","block"),
U.css("display","none"),$.removeClass("noComments negative").css("display","none"),J.css("display","none"),pe.commentsCache[n.comments.backend]==e?(N.css("display","block"),o.ajax({data:{action:"list_comments"},dataType:"json",type:"GET",url:n.comments.backend,timeout:15e3,cache:!1,error:function(){s==pe.activeItem&&$.addClass("negative").removeClass("noComments").text(ce("Comments are currently unavalible")).css("display","block")},success:function(e){pe.commentsCache[n.comments.backend]=e,s==pe.activeItem&&(re.itemDetails.comments.display(e),m.data("plugin_eds_tinyscrollbar").update())}})):re.itemDetails.comments.display(pe.commentsCache[n.comments.backend])),"object"==typeof n.author?(g.css("display","block"),u="string"==typeof n.author.url&&""!=n.author.url?n.author.url:"","string"==typeof n.author.avatar&&""!=n.author.avatar?(y.css("display","block"),b.empty(),i=""==u?b:o('<a href="#" />').appendTo(b).attr({href:u}),re.itemDetails.placeAvatar({src:n.author.avatar,$container:i})):y.css("display","none"),w.empty(),""==u?w.text(n.author.name):w.append(o("<a />").attr({href:u}).text(n.author.name)),k.html(n.author.dateHtml),n.author.isUser!=e&&n.author.isUser?C.css("display","none"):(C.css("display","block"),n.author.following==e?I.css("display","none"):(I.data("disabled",!1).css("display","block"),n.author.following?I.addClass("unfollow").find("> span").text(ce("unfollow")):I.removeClass("unfollow").find("> span").text(ce("follow"))),x.css("display","none").removeClass("requesting"),n.author.friends==e?D.css("display","none"):(D.removeClass("requesting unfriend cancelRequest acceptRequest").data("disabled",!1).css("display","block"),n.author.friends===!0?D.addClass("unfriend").find("> span").text(ce("unfriend")):"requested_by_user"==n.author.friends?D.addClass("cancelRequest").find("> span").text(ce("cancel friend request")):"requested_by_author"==n.author.friends?(D.addClass("acceptRequest").find("> span").text(ce("accept friend request")),x.css("display","block")):D.find("> span").text(ce("add as friend"))))):g.css("display","none"),"object"==typeof n.likes?(T.css("display","block"),"string"==typeof n.likes.backend&&""!=n.likes.backend?(_.css("display","").data("disabled",!1),n.likes.liked?_.addClass("unlike").find("> span").text(ce("unlike")):_.removeClass("unlike").find("> span").text(ce("like"))):_.css("display","none"),"string"!=typeof n.likes.message||""==n.likes.message?A.css("display","none"):A.removeClass("negative").css("display","block").text(n.likes.message),"object"!=typeof n.likes.alsoLiked||0==n.likes.alsoLiked.length?M.css("display","none"):(M.css("display","block").empty(),o.each(n.likes.alsoLiked,function(e,t){var a=o("<li><div></div></li>").appendTo(M),i=a.find("> div");"string"==typeof t.url&&""!=t.url&&(i=i.html('<a href="'+t.url+'"></a>').find("> a")),i.attr("title",t.name),re.itemDetails.placeAvatar({src:t.avatar,$container:i})}))):T.css("display","none"),"object"==typeof n.tags?(o.each(n.tags,function(e,t){r+='<li data-id="'+e+'"><span>'+t+"</span></li>"}),""==r?H.css("display","none"):H.css("display","block").html(r)):H.css("display","none"),"string"!=typeof n.download||""==n.download?P.css("display","none"):(l=!0,P.attr("href",n.download).css("display","")),"object"==typeof n.email?(l=!0,E.attr("href","mailto:?to=&subject="+encodeURIComponent(n.email.subject)+"&body="+encodeURIComponent(n.email.body)).css("display","")):E.css("display","none"),R.css("display",l?"block":"none"),"object"==typeof n.meta){if(Q.css("display","block"),"object"==typeof n.meta.exif&&(p='<div class="exif"><h4><span>'+ce("Exif")+"</span></h4><table><tbody>",o.each(n.meta.exif,function(e,t){p+='<tr><td class="cell1">'+e+'</td><td class="cell2">'+t+"</td></tr>"}),ee.html(p+"</tbody></table></div>")),"object"==typeof n.meta.map)switch(ee.append('<div class="map">'+(n.meta.map.title==e?"":"<h4><span>"+n.meta.map.title+"</span></h4>")+"<div></div></div>"),pe.itemDetails.maps.google=null,n.meta.map.type){case"google":"object"==typeof google&&"object"==typeof google.maps&&(a=new google.maps.LatLng(n.meta.map.settings.lat,n.meta.map.settings.lng),pe.itemDetails.maps.google=new google.maps.Map(o("> div.map > div",ee)[0],{center:a,zoom:n.meta.map.settings.zoom,mapTypeId:google.maps.MapTypeId[n.meta.map.settings.type],scrollwheel:!1}),new google.maps.Marker({position:a,map:pe.itemDetails.maps.google}))}ee.css({display:"none"})}else Q.css("display","none");m.data("plugin_eds_tinyscrollbar").update()}},re.itemDetails.resize=function(){le.itemDetails.show&&(m.height(pe.baseWrapper.height-pe.itemDetails.wrapper.verticalOffset-pe.thumbnails.wrapper.effectiveHeight-pe.interfaceActions.wrapper.height),m.data("plugin_eds_tinyscrollbar").update("relative"))},re.itemDisplay={},re.itemDisplay.init=function(){te=o('<div class="itemDisplayWrapper '+(le.itemDetails.rightSide?"left":"right")+'"></div>'),s.append(te),pe.itemDisplay.wrapper.verticalOffset=te.outerHeight(!0)-te.height(),pe.itemDisplay.wrapper.horizontalOffset=te.outerWidth(!0)-te.width(),ae=o('<div class="itemDisplayContainer"></div>').appendTo(te),ie=o('<div class="loadIndicator"></div>').appendTo(te)},re.itemDisplay.resize=function(){var e,t,a,i,s,n,r,l,c,d=de[pe.activeItem];switch(pe.itemDisplay.wrapper.height=pe.baseWrapper.height-pe.itemDisplay.wrapper.verticalOffset-pe.thumbnails.wrapper.effectiveHeight-pe.interfaceActions.wrapper.height,pe.itemDisplay.wrapper.width=pe.baseWrapper.width-pe.itemDisplay.wrapper.horizontalOffset-pe.itemDetails.wrapper.effectiveWidth,te.height(pe.itemDisplay.wrapper.height).width(pe.itemDisplay.wrapper.width),s=o("> .item.active",ae),d.type){case"image":if(0==s.length)return;n={width:pe.preloadedImages[d.src].width,height:pe.preloadedImages[d.src].height};break;case"video":n={width:d.video.width,height:d.video.height};break;case"audio":n={width:450,height:s.height()}}l={width:ae.width(),height:ae.height()},"video"==d.type||"image"==d.type&&(n.width>l.width||n.height>l.height)||"audio"==d.type&&n.width>l.width?(c=l.width/l.height,r=n.width/n.height,e=l.width,t="audio"==d.type?n.height:l.height,c>r?e=Math.round(l.height/n.height*n.width):r>c&&"audio"!=d.type&&(t=Math.round(l.width/n.width*n.height))):(e=n.width,t=n.height),i=Math.floor((l.width-e)/2),a=Math.floor((l.height-t)/2),s.css({width:e,height:t,marginTop:a,marginLeft:i})},re.itemDisplay.showItem=function(){var t,a,i,s=pe.activeItem,r=de[s],l=function(){t=ae.find(">").fadeOut(200,function(){t.remove()}).removeClass("active"),o('<img class="item active" src="'+r.src+'" alt="" style="display: none;" />').appendTo(ae).fadeIn(200),re.itemDisplay.resize(),ie.stop(!0).fadeOut(500)},c="";switch(r.type){case"image":pe.preloadedImages[r.src]!==e&&"success"==pe.preloadedImages[r.src].state?l():(ie.css({display:"none",left:0}).stop(!0).fadeIn(500,function(){ae.find(">").remove()}),re.preloadImage(r.src,function(){s==pe.activeItem&&l()}));break;case"video":switch(t=ae.find(">").removeClass("active").fadeOut(200,function(){t.remove()}),r.video.provider){case"youtube":a='<iframe class="item active" style="display: none;" src="//www.youtube.com/embed/'+r.video.id+'?wmode=opaque" frameborder="0" allowfullscreen></iframe>';break;case"vimeo":a='<iframe class="item active" style="display: none;" src="//player.vimeo.com/video/'+r.video.id+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';break;case"wistia":a='<iframe class="wistia_embed item active" name="wistia_embed" style="display: none;" src="//fast.wistia.net/embed/iframe/'+r.video.id+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';break;case"flowplayer":a='<div class="item active" style="display: block; opacity: 0;"></div>'}i=o(a).appendTo(ae),"flowplayer"==r.video.provider?(n(r.video.src,".mp4")?c="video/mp4":n(r.video.src,".webm")?c="video/webm":n(r.video.src,".ogg")?c="video/ogg":n(r.video.src,".flv")&&(c="video/flash"),i.animate({opacity:1},200).flowplayer({swf:le.flowplayerSwf,tooltip:!1,embed:!1,key:le.flowplayer.key,logo:le.flowplayer.logo,clip:{sources:[{type:c,src:r.video.src}]}})):i.fadeIn(200),ie.stop(!0).fadeOut(500),re.itemDisplay.resize();break;case"audio":t=ae.find(">").removeClass("active").fadeOut(200,function(){t.remove()}),i=o('<div class="item active" style="display: block; opacity: 0;"><audio src="'+r.audio.src+'" /></div>').appendTo(ae).animate({opacity:1},200),audiojs.create(o("> audio",i)[0]),ie.stop(!0).fadeOut(500),re.itemDisplay.resize()}},arguments.length>0&&o.extend(!0,le,arguments[0]),this.each(function(){var e=o(this).data("socialMediaBox");e&&(e instanceof Array?o.each(e,function(){de.push(this)}):de.push(e))}),0==de.length?this:(t=o("body").addClass("socialMediaBoxActive"),s=o('<div id="socialMediaBox" class="'+le.baseClass+'" style="visibility: hidden;"></div>').appendTo(t),re.thubnails.init(),re.itemDetails.init(),re.itemDisplay.init(),re.interfaceActions.init(),de.length>1&&(se=o('<div class="navigation previous '+(le.itemDetails.rightSide?"left":"right")+'"></div>').appendTo(s),ne=o('<div class="navigation next '+(le.itemDetails.rightSide?"left":"right")+'"></div>').appendTo(s)),oe=o('<div class="close"><span></span></div>'),s.append(oe),re.resize(),re.showItem(le.openAt,!0),s.css({display:"none",visibility:""}).fadeIn(200).on("click","> div.navigation",function(){o(this).hasClass("previous")?re.showItem(pe.activeItem-1):re.showItem(pe.activeItem+1)}),oe.on("click",function(){re.close()}),o(document).on("keyup.socialMediaBox",function(e){var t=o(document.activeElement);if(0!=t.filter("textarea").parents(".commentsWrapper").length||t.filter("input").parents(".commentsWrapper").length)return!1;switch(e.keyCode){case 37:re.showItem(pe.activeItem-1);break;case 39:re.showItem(pe.activeItem+1);break;case 27:re.close()}return!1}),ae.on("touchstart",function(e){"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),e.originalEvent.touches&&e.originalEvent.touches.length?e=e.originalEvent.touches[0]:e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length&&(e=e.originalEvent.changedTouches[0]),pe.itemDisplay.touch.newTouch=!0,pe.itemDisplay.touch.startX=e.pageX,pe.itemDisplay.touch.startY=e.pageY}).on("touchmove",function(e){var t;"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),pe.itemDisplay.touch.newTouch&&(e.originalEvent.touches&&e.originalEvent.touches.length?e=e.originalEvent.touches[0]:e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length&&(e=e.originalEvent.changedTouches[0]),t=pe.itemDisplay.touch.startX-e.pageX,Math.abs(t)<50||(pe.itemDisplay.touch.newTouch=!1,t>0?re.showItem(pe.activeItem+1):re.showItem(pe.activeItem-1)))}).on("touchend touchcancel",function(e){"function"==typeof e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),pe.itemDisplay.touch.newTouch=!1}),o(window).on("resize.socialMediaBox",function(){re.resize()}),this)},o.fn.socialMediaBox4Journal=function(e){var i;if(!t)return t=!0,i=function(){var t,i,n,r=o(this),l=r.parents(".journalrow")[0].id,c="",d=0,p=o('<div id="socialMediaBox4JournalOverlay"'+("object"==typeof e.smbConfig&&e.smbConfig.baseClass?' class="'+e.smbConfig.baseClass+'"':"")+"><div></div><p></p></div>"),m=o("> p",p),u=o("> div",p),h=o("body"),v="",f=function(){o(document).off(".socialMediaBox4Journal"),p.fadeTo(400,0,function(){p.remove()}),h.removeClass("socialMediaBoxActive"),m.css("display","none")};h.append(p).addClass("socialMediaBoxActive"),p.fadeTo(400,1).on("click","> p > .close",function(){return f(),!1}),o.each(r.parents("#journalItems").eq(0).find(">").has(".journalitem > .jphoto"),function(t,a){a.id==l&&(e.smbConfig.openAt=t),c+=a.id.substring(a.id.indexOf("-")+1)+","}),c=c.substring(0,c.length-1),d=s(r.parents(".DnnModule-Journal").eq(0)),t=a(),n=o.ajax({data:{action:"journal_entries",journalIds:c,journalModuleId:d,journalType:t.type,journalTarget:t.target},dataType:"json",type:"POST",url:e.entriesUrl,timeout:15e3,cache:!1,error:function(){v=e.errors.generalError},success:function(t){"success"==t.status?(i=t.entries,0==i.length&&(v=e.errors.noJournalItems)):v=t.message},complete:function(){return""!=v?(u.fadeTo(200,0,function(){u.css("display","none")}),void m.html(v+'<span class="close">X</span>').css({display:"block",opacity:0}).fadeTo(200,1)):(f(),void o("<div />").data("socialMediaBox",i).socialMediaBox(e.smbConfig))}}),o(document).on("keyup.socialMediaBox4Journal",function(e){return 27==e.keyCode?(n.abort(),f(),!1):void 0})},o(".DnnModule-Journal").on("click",".journalitem > .jphoto a",function(){return i.call(this),!1}).on("click",".journalitem > .jphoto > img",i).on("mouseenter",".journalitem > .jphoto > img",function(){var e=o(this);e.css("cursor","pointer")}),this}};"undefined"!=typeof eds2_2&&o(eds2_2)}();